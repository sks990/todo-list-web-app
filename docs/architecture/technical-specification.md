# 기술 사양서: 통합 데이터 일관성 및 오류 복구 아키텍처

## 1. 개요
본 문서는 QA 테스트 결과 발견된 동시성 이슈 및 서비스 간 데이터 불일치 문제를 해결하기 위한 최종 아키텍처 사양을 정의한다.

## 2. 핵심 기술 요구사항
- **멱등성(Idempotency) 보장**: 모든 API 및 메시지 핸들러는 중복 요청에 대해 동일한 결과를 보장해야 함.
- **분산 트랜잭션 관리**: Saga 패턴(Outbox 패턴 포함)을 활용하여 마이크로서비스 간 최종 일관성을 유지함.
- **실패 복구 전략**: 지수 백오프(Exponential Backoff)를 적용한 재시도 메커니즘 구축.

## 3. 수정 보완 사항 (QA 피드백 반영)
- **Issue #102**: 결제 프로세스 중 네트워크 지연 시 중복 결제 발생 위험. -> **Solution**: 클라이언트 토큰 기반 멱등성 키 적용.
- **Issue #105**: 트랜잭션 롤백 시 메시지 큐 비동기 알림 누락. -> **Solution**: Transactional Outbox 패턴 적용.

## 4. 아키텍처 다이어그램 (추상화)